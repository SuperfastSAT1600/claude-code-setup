{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  },
  "hooks": {
    "SessionStart": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/plan-mode-session-start.sh"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "tool in [\"Edit\", \"Write\", \"Task\", \"Bash\"]",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/enforce-spec-before-coding.sh"
          }
        ]
      },
      {
        "matcher": "tool in [\"Edit\", \"Write\", \"Task\"]",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/verify-errors-read.sh"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\"",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/verify-errors-read.sh"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git push.*(main|master)\"",
        "hooks": [
          {
            "type": "command",
            "command": "echo '[Hook] Pushing to main/master branch - ensure tests pass and code is reviewed!' >&2"
          }
        ]
      },
      {
        "matcher": "tool in [\"Edit\", \"Write\"] && tool_input.file_path matches \"\\\\.(env|credentials|secret|pem|key)$\"",
        "hooks": [
          {
            "type": "command",
            "command": "echo '[Hook] BLOCKED: Cannot write to sensitive files (.env, .pem, .key, credentials)' >&2 && exit 2"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\"",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/block-dangerous-commands.sh \"$tool_input_command\""
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git commit\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/pre-commit-checks.sh\" ]; then\n  bash ./.claude/scripts/pre-commit-checks.sh 2>&1 | head -50\nfi"
          },
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/req-coverage.sh\" ]; then\n  bash ./.claude/scripts/req-coverage.sh 2>&1 | head -30 || true\nfi"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"gh pr create\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/checkpoint.sh\" ]; then\n  bash ./.claude/scripts/checkpoint.sh\nelif [ -f \".claude/scripts/require-tests-pass.sh\" ]; then\n  bash ./.claude/scripts/require-tests-pass.sh\nfi"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"npm publish|yarn publish|pnpm publish\"",
        "hooks": [
          {
            "type": "command",
            "command": "echo '[Hook] Publishing package - ensure version is bumped and tests pass!' >&2"
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "subagent_name == \"code-reviewer\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/log-security-review.sh\" ]; then\n  bash ./.claude/scripts/log-security-review.sh 2>&1 | head -10\nfi || true"
          }
        ]
      },
      {
        "matcher": "subagent_name matches \".*\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/log-session-event.sh\" ]; then\n  bash ./.claude/scripts/log-session-event.sh agent_completed subagent completed 2>/dev/null\nfi || true"
          }
        ]
      }
    ],
    "TeammateIdle": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/hooks/teammate-idle-tdd.sh"
          }
        ]
      }
    ],
    "TaskCompleted": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/hooks/task-completed-tdd.sh"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "tool == \"Write\" && tool_input.file_path matches \"\\.claude/plans/.*\\.md$\"",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/clear-plan-flag.sh"
          },
          {
            "type": "command",
            "command": "bash ./.claude/scripts/launch-parallel-tdd.sh"
          }
        ]
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\.claude/plans/.*\\.md$\"",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/clear-plan-flag.sh"
          }
        ]
      },
      {
        "matcher": "tool == \"Read\" && tool_input.file_path matches \"errors\\\\.md$\"",
        "hooks": [
          {
            "type": "command",
            "command": "bash ./.claude/scripts/mark-errors-read.sh && bash ./.claude/scripts/detect-error-patterns.sh"
          }
        ]
      },
      {
        "matcher": "tool in [\"Edit\", \"Write\"] && tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx|json|css|scss|md)$\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/auto-format.sh\" ]; then\n  bash ./.claude/scripts/auto-format.sh \"$file_path\" 2>/dev/null\nelse\n  npx prettier --write \"$file_path\" 2>/dev/null || true\nfi"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git commit\"",
        "hooks": [
          {
            "type": "command",
            "command": "echo '[Hook] Commit created. Consider running tests before pushing.' >&2"
          }
        ]
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"npm install|yarn add|pnpm add\"",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \".claude/scripts/sync-deps.sh\" ]; then\n  bash ./.claude/scripts/sync-deps.sh 2>&1 | head -20\nfi || true"
          }
        ]
      }
    ]
  },
  "enabledPlugins": {
    "context7@claude-plugins-official": true,
    "frontend-design@claude-plugins-official": true
  },
  "allowedPrompts": [
    { "tool": "Bash", "prompt": "run tests" },
    { "tool": "Bash", "prompt": "run unit tests" },
    { "tool": "Bash", "prompt": "run e2e tests" },
    { "tool": "Bash", "prompt": "run type checking" },
    { "tool": "Bash", "prompt": "build the project" },
    { "tool": "Bash", "prompt": "install dependencies" },
    { "tool": "Bash", "prompt": "run linter" },
    { "tool": "Bash", "prompt": "format code" },
    { "tool": "Bash", "prompt": "git status" },
    { "tool": "Bash", "prompt": "git diff" },
    { "tool": "Bash", "prompt": "git log" },
    { "tool": "Bash", "prompt": "git branch" },
    { "tool": "Bash", "prompt": "git add files" },
    { "tool": "Bash", "prompt": "git commit" },
    { "tool": "Bash", "prompt": "git push" },
    { "tool": "Bash", "prompt": "list files" },
    { "tool": "Bash", "prompt": "start development server" },
    { "tool": "Bash", "prompt": "stop development server" },
    { "tool": "Bash", "prompt": "run docker commands" },
    { "tool": "Bash", "prompt": "run database migrations" },
    { "tool": "Bash", "prompt": "audit dependencies" },
    { "tool": "Bash", "prompt": "run security scans" },
    { "tool": "Bash", "prompt": "run pre-commit checks" }
  ],
  "thinkingEnabled": true,
  "autoAcceptEdits": false,
  "permissions": {
    "defaultMode": "plan"
  }
}
